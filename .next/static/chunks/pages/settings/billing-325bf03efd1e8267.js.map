{"version":3,"file":"static/chunks/pages/settings/billing-325bf03efd1e8267.js","mappings":"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","sources":["webpack://_N_E/./node_modules/@mui/icons-material/utils/createSvgIcon.js","webpack://_N_E/./node_modules/@mui/material/utils/createChainedFunction.js","webpack://_N_E/./node_modules/@mui/utils/deprecatedPropType/deprecatedPropType.js","webpack://_N_E/./node_modules/@mui/material/utils/deprecatedPropType.js","webpack://_N_E/./node_modules/@mui/utils/requirePropFactory/requirePropFactory.js","webpack://_N_E/./node_modules/@mui/material/utils/requirePropFactory.js","webpack://_N_E/./node_modules/@mui/material/utils/setRef.js","webpack://_N_E/./node_modules/@mui/utils/unsupportedProp/unsupportedProp.js","webpack://_N_E/./node_modules/@mui/material/utils/unsupportedProp.js","webpack://_N_E/./node_modules/@mui/material/utils/index.js","webpack://_N_E/./node_modules/@mui/material/utils/useId.js","webpack://_N_E/?c003","webpack://_N_E/./lib/notify.ts","webpack://_N_E/./pages/settings/PaymentMethodForm.tsx","webpack://_N_E/./pages/settings/billing.tsx","webpack://_N_E/./node_modules/@mui/icons-material/node_modules/@babel/runtime/helpers/interopRequireDefault.js","webpack://_N_E/<anon>"],"sourcesContent":["\"use strict\";\n'use client';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"default\", {\n  enumerable: true,\n  get: function () {\n    return _utils.createSvgIcon;\n  }\n});\nvar _utils = require(\"@mui/material/utils\");","import createChainedFunction from '@mui/utils/createChainedFunction';\nexport default createChainedFunction;","export default function deprecatedPropType(validator, reason) {\n  if (process.env.NODE_ENV === 'production') {\n    return () => null;\n  }\n  return (props, propName, componentName, location, propFullName) => {\n    const componentNameSafe = componentName || '<<anonymous>>';\n    const propFullNameSafe = propFullName || propName;\n    if (typeof props[propName] !== 'undefined') {\n      return new Error(`The ${location} \\`${propFullNameSafe}\\` of ` + `\\`${componentNameSafe}\\` is deprecated. ${reason}`);\n    }\n    return null;\n  };\n}","import deprecatedPropType from '@mui/utils/deprecatedPropType';\nexport default deprecatedPropType;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nexport default function requirePropFactory(componentNameInError, Component) {\n  if (process.env.NODE_ENV === 'production') {\n    return () => null;\n  }\n\n  // eslint-disable-next-line react/forbid-foreign-prop-types\n  const prevPropTypes = Component ? _extends({}, Component.propTypes) : null;\n  const requireProp = requiredProp => (props, propName, componentName, location, propFullName, ...args) => {\n    const propFullNameSafe = propFullName || propName;\n    const defaultTypeChecker = prevPropTypes == null ? void 0 : prevPropTypes[propFullNameSafe];\n    if (defaultTypeChecker) {\n      const typeCheckerResult = defaultTypeChecker(props, propName, componentName, location, propFullName, ...args);\n      if (typeCheckerResult) {\n        return typeCheckerResult;\n      }\n    }\n    if (typeof props[propName] !== 'undefined' && !props[requiredProp]) {\n      return new Error(`The prop \\`${propFullNameSafe}\\` of ` + `\\`${componentNameInError}\\` can only be used together with the \\`${requiredProp}\\` prop.`);\n    }\n    return null;\n  };\n  return requireProp;\n}","import requirePropFactory from '@mui/utils/requirePropFactory';\nexport default requirePropFactory;","import setRef from '@mui/utils/setRef';\nexport default setRef;","export default function unsupportedProp(props, propName, componentName, location, propFullName) {\n  if (process.env.NODE_ENV === 'production') {\n    return null;\n  }\n  const propFullNameSafe = propFullName || propName;\n  if (typeof props[propName] !== 'undefined') {\n    return new Error(`The prop \\`${propFullNameSafe}\\` is not supported. Please remove it.`);\n  }\n  return null;\n}","import unsupportedProp from '@mui/utils/unsupportedProp';\nexport default unsupportedProp;","'use client';\n\nimport { unstable_ClassNameGenerator as ClassNameGenerator } from '@mui/base/ClassNameGenerator';\nexport { default as capitalize } from './capitalize';\nexport { default as createChainedFunction } from './createChainedFunction';\nexport { default as createSvgIcon } from './createSvgIcon';\nexport { default as debounce } from './debounce';\nexport { default as deprecatedPropType } from './deprecatedPropType';\nexport { default as isMuiElement } from './isMuiElement';\nexport { default as ownerDocument } from './ownerDocument';\nexport { default as ownerWindow } from './ownerWindow';\nexport { default as requirePropFactory } from './requirePropFactory';\nexport { default as setRef } from './setRef';\nexport { default as unstable_useEnhancedEffect } from './useEnhancedEffect';\nexport { default as unstable_useId } from './useId';\nexport { default as unsupportedProp } from './unsupportedProp';\nexport { default as useControlled } from './useControlled';\nexport { default as useEventCallback } from './useEventCallback';\nexport { default as useForkRef } from './useForkRef';\nexport { default as useIsFocusVisible } from './useIsFocusVisible';\n// TODO: remove this export once ClassNameGenerator is stable\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport const unstable_ClassNameGenerator = {\n  configure: generator => {\n    if (process.env.NODE_ENV !== 'production') {\n      console.warn(['MUI: `ClassNameGenerator` import from `@mui/material/utils` is outdated and might cause unexpected issues.', '', \"You should use `import { unstable_ClassNameGenerator } from '@mui/material/className'` instead\", '', 'The detail of the issue: https://github.com/mui/material-ui/issues/30011#issuecomment-1024993401', '', 'The updated documentation: https://mui.com/guides/classname-generator/'].join('\\n'));\n    }\n    ClassNameGenerator.configure(generator);\n  }\n};","'use client';\n\nimport useId from '@mui/utils/useId';\nexport default useId;","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/settings/billing\",\n      function () {\n        return require(\"private-next-pages/settings/billing.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/settings/billing\"])\n      });\n    }\n  ","import { openSnackbarExternal } from '../components/common/Notifier';\n\nexport default function notify(obj) {\n  openSnackbarExternal({ message: obj.message || obj.toString() });\n}\n","import React, { useState, useEffect } from 'react';\nimport { Button } from '@mui/material';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { Elements } from '@stripe/react-stripe-js';\nimport { sendApiRequest } from 'lib/api/public';\nimport notify from 'lib/notify';\n\nconst stripePromise = loadStripe(process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY);\n\nimport { CardElement, useStripe, useElements } from '@stripe/react-stripe-js';\n\ntype Props = {\n    afterFetch?: (response: any) => void,\n    onSuccess?: (response: any) => void,\n}\n\nconst CheckoutForm = ({ afterFetch, onSuccess }: Props) => {\n    const [isSaving, setIsSaving] = useState(false);\n    const [isLoading, setIsLoading] = useState(false);\n    const [paymentInfo, setPaymentInfo] = useState(null);\n    const stripe = useStripe();\n    const elements = useElements();\n\n    const fetchPaymentInfo = async () => {\n        setIsLoading(true);\n\n        try {\n            const response = await sendApiRequest({\n                path: '/payment-info',\n                method: 'GET',\n            });\n\n            setPaymentInfo(response);\n\n            if (afterFetch) {\n                afterFetch(response);\n            }\n\n            setIsLoading(false);\n        } catch (error) {\n            setIsLoading(false);\n            notify(error);\n        }\n    };\n\n    useEffect(() => {\n        fetchPaymentInfo();\n    }, []);\n\n    const handleSubmit = async (event) => {\n        event.preventDefault();\n\n        if (!stripe || !elements) {\n            // Stripe.js has not yet loaded.\n            return;\n        }\n\n        const { error, paymentMethod } = await stripe.createPaymentMethod({\n            type: 'card',\n            card: elements.getElement(CardElement),\n        });\n\n        if (error) {\n            notify(error);\n        } else {\n            try {\n                setIsSaving(true);\n\n                const response = await sendApiRequest({\n                    path: '/save-payment-method',\n                    method: 'POST',\n                    data: {\n                        paymentMethod,\n                    }\n                });\n\n                notify('Payment method saved');\n\n                setPaymentInfo(response);\n\n                if (onSuccess) {\n                    onSuccess(response);\n                }\n\n                setIsSaving(false);\n            } catch (error) {\n                setIsSaving(false);\n                notify(error);\n            }\n        }\n    };\n\n    if (isLoading || !paymentInfo) {\n        return null;\n    }\n\n    return (\n        <form onSubmit={handleSubmit}>\n            <CardElement className=\"StripeElement\" />\n\n            <Button variant=\"contained\" color=\"primary\" type=\"submit\" disabled={!stripe || isSaving}>\n                {paymentInfo.paymentMethodId ? 'Update' : 'Add'} payment method\n            </Button>\n        </form>\n    );\n};\n\nfunction PaymentMethodForm({ onSuccess, afterFetch }: Props) {\n    return (\n        <Elements stripe={stripePromise}>\n            <CheckoutForm onSuccess={onSuccess} afterFetch={afterFetch} />\n        </Elements>\n    );\n}\n\nexport default PaymentMethodForm;\n","import React, { useEffect, useState } from 'react';\nimport AuthLayout from '../../components/AuthLayout';\nimport { sendApiRequest } from 'lib/api/public';\nimport { CreditCard } from '@mui/icons-material';\nimport PaymentMethodForm from './PaymentMethodForm';\nimport { Box } from '@mui/material';\n\nconst Billing = () => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [cardDetails, setCardDetails] = useState(null);\n\n  const fetchPaymentInfo = async () => {\n    setIsLoading(true);\n\n    try {\n      const response = await sendApiRequest({\n        path: '/payment-info?cardDetails=true',\n        method: 'GET',\n      });\n\n      setCardDetails(response.cardDetails);\n\n      setIsLoading(false);\n    } catch (error) {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchPaymentInfo();\n  }, []);\n\n  return (\n    <AuthLayout title='Billing' isLoading={isLoading}>\n      <Box>\n        {cardDetails ? (\n          <div>\n            <div style={{ display: 'flex', alignItems: 'center' }}>\n              Credit card:  <CreditCard /> ....{cardDetails.last4}\n            </div>\n            <br />\n          </div>\n          ) : null\n        }\n\n        <PaymentMethodForm onSuccess={fetchPaymentInfo} />\n      </Box>\n    </AuthLayout>\n  );\n};\n\nexport default Billing;","function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\nmodule.exports = _interopRequireDefault, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;"],"names":["Object","defineProperty","exports","value","enumerable","get","_utils","createSvgIcon","__webpack_require__","__webpack_exports__","Z","_mui_utils_createChainedFunction__WEBPACK_IMPORTED_MODULE_0__","utils_deprecatedPropType","validator","reason","utils_requirePropFactory","componentNameInError","Component","utils_setRef","setRef","utils_unsupportedProp","props","propName","componentName","location","propFullName","unstable_ClassNameGenerator","configure","generator","ClassNameGenerator","_mui_utils_useId__WEBPACK_IMPORTED_MODULE_0__","window","__NEXT_P","push","notify","obj","openSnackbarExternal","message","toString","stripePromise","loadStripe","process","CheckoutForm","afterFetch","onSuccess","param","isSaving","setIsSaving","useState","isLoading","setIsLoading","paymentInfo","setPaymentInfo","stripe","useStripe","elements","useElements","fetchPaymentInfo","response","sendApiRequest","path","method","error","useEffect","handleSubmit","event","preventDefault","paymentMethod","createPaymentMethod","type","card","getElement","CardElement","data","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","jsxs","form","onSubmit","jsx","className","Button","variant","color","disabled","paymentMethodId","Elements","cardDetails","setCardDetails","AuthLayout","title","Box","div","style","display","alignItems","CreditCard","last4","br","PaymentMethodForm","module","__esModule"],"sourceRoot":""}