"use strict";exports.id=2656,exports.ids=[2656],exports.modules={19735:(e,t,a)=>{var n=a(81112);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,function(e,t){if((t||!e||!e.__esModule)&&null!==e&&("object"==typeof e||"function"==typeof e)){var a=s(t);if(a&&a.has(e))return a.get(e);var n={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=l?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=e[r]}n.default=e,a&&a.set(e,n)}}(a(16689));var l=n(a(86357)),r=a(20997);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(s=function(e){return e?a:t})(e)}t.default=(0,l.default)((0,r.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},38698:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(20997),l=a(16689),r=a(83733),s=a.n(r);let i=({onClick:e})=>{let[t,a]=(0,l.useState)(!1);return n.jsx(s(),{style:{cursor:"pointer",color:t?"#dc5e7f":"#f2a1b6"},onMouseOver:()=>a(!0),onMouseLeave:()=>a(!1),onClick:e})}},94296:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{Z:()=>f});var l=a(20997),r=a(16689),s=a(62553),i=a(49048),o=a.n(i),d=a(33500),u=a.n(d),c=a(98416),h=a.n(c),m=a(38698),p=e([s]);s=(p.then?(await p)():p)[0];let f=({label:e,onChange:t,multiple:a=!0,showList:n=!0,defaultFiles:i})=>{let[d,c]=(0,r.useState)(!1),[p,f]=(0,r.useState)(i||[]),x=e=>{let n=p.filter(t=>t.url!==e.url);f(n),a?t(n):t(n[0])};return(0,l.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[l.jsx("input",{type:"file",id:`uploader-${e}`,onChange:e=>{let n=e.target.files;for(let e of n){let l=new FormData;l.append("file",e),c(!0),(0,s.Ap)(l).then(l=>{c(!1),l.json().then(({result:l})=>{p.push({url:l,date:new Date,name:e.name}),f([...p]),n.length===p.length&&(a?t(p):t(p[0]))}).catch(e=>{console.error(e.message)})}).catch(e=>{c(!1),console.error(e.message)})}},style:{display:"none"},multiple:a}),(0,l.jsxs)("label",{htmlFor:`uploader-${e}`,style:{padding:"10px 35px",borderRadius:"5px",width:"215px !important",cursor:"pointer",background:"#ebecf0",color:"#4f4f51",border:"1px solid #dfe0e4",position:"relative"},children:[l.jsx("div",{style:{position:"absolute",height:"20px",left:"5px",top:"10px"},children:d?l.jsx(o(),{size:20}):l.jsx(h(),{})}),e]}),n?(0,l.jsxs)(l.Fragment,{children:[p.length>0?(0,l.jsxs)(l.Fragment,{children:[l.jsx("br",{}),l.jsx("br",{})]}):null,l.jsx(u(),{children:p.map(e=>(0,l.jsxs)("div",{style:{display:"flex"},children:[l.jsx(m.Z,{onClick:()=>x(e)}),l.jsx("a",{href:(0,s.pJ)(e.url),target:"__blank",children:e.name})]}))})]}):null]})};n()}catch(e){n(e)}})},69708:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(42134);function l(e){(0,n.l)({message:e.message||e.toString()})}},2992:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.r(t),a.d(t,{default:()=>Z});var l=a(20997),r=a(16689),s=a(51546),i=a.n(s),o=a(11163),d=a(62553),u=a(11256),c=a.n(u),h=a(7988),m=a.n(h),p=a(34904),f=a.n(p),x=a(9285),j=a.n(x),y=a(78316),g=a.n(y),b=a(86096),v=a.n(b),S=a(69708),w=a(40063),C=a(94296),F=e([d,C]);[d,C]=F.then?(await F)():F;let M=(0,d.zH)().replace("https://","").replace("http://","").replace("www.",""),Z=({requireSubdomain:e=!1})=>{let t=(0,o.useRouter)(),[a,n]=(0,r.useState)(!0),[s,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(null),[x,y]=(0,r.useState)(null),[b,F]=(0,r.useState)(!0),Z=async()=>{try{let e=await (0,d.Gy)({path:"/organization",method:"GET"});p(e),y(e.subdomain),n(!1)}catch(e){n(!1)}},_=async e=>{try{let t=await (0,d.Gy)({path:"/organization/check-subdomain",method:"POST",data:{subdomain:e}});F(t)}catch(e){console.error(e)}};(0,r.useEffect)(()=>{Z()},[]);let P=(e,t)=>{p({...h,[e]:t})},E=e=>{let t=e.target.value;p({...h,name:t})},O=e=>{let t=e.target.value;if(!x){let e=i()(t);y(e),y(e),_(e)}},k=e=>{let t=e.target.value;y(t),_(t)},G=async()=>{if(!b){(0,S.Z)("Subdomain is not available");return}if(!h.name){(0,S.Z)("Name is required");return}if(e&&!x){(0,S.Z)("Subdomain is required");return}try{u(!0),await (0,d.Gy)({path:"/organization",method:"POST",data:{name:h.name,website:h.website,subdomain:b?x:null,logo:h.logo}}),u(!1),x?((0,S.Z)("You will be logged out and redirected to the new subdomain."),setTimeout(()=>{t.push(`/auth/logout?subdomain=${x}`)},3e3)):(0,S.Z)("Organization updated successfully")}catch(e){u(!1),(0,S.Z)(e.message)}};return a||!h?l.jsx(c(),{}):(0,l.jsxs)(l.Fragment,{children:[(0,w.fM)({label:"Name",required:!0,renderControl:()=>l.jsx(m(),{fullWidth:!0,value:h.name,onChange:E,onBlur:O})}),(0,w.fM)({label:"Subdomain",required:e,renderControl:()=>(0,l.jsxs)(l.Fragment,{children:[l.jsx(m(),{fullWidth:!0,onChange:k,value:x}),l.jsx(f(),{variant:"caption",children:`https://${x||""}${x?".":""}${M}`}),l.jsx(j(),{children:!b&&l.jsx(f(),{variant:"caption",color:"red",children:"Subdomain is not available"})})]})}),(0,w.fM)({label:"Website",renderControl:()=>l.jsx(m(),{fullWidth:!0,onChange:e=>P("website",e.target.value),value:h?.website})}),(0,w.fM)({label:"Logo",renderControl:()=>{let e=h.logo;return(0,l.jsxs)(l.Fragment,{children:[e&&(0,l.jsxs)(l.Fragment,{children:[l.jsx(g(),{src:(0,d.pJ)(e),alt:"Logo"}),l.jsx("br",{}),l.jsx("br",{})]}),l.jsx(C.Z,{label:"Upload",multiple:!1,defaultFiles:e?[{name:e,url:e}]:[],onChange:e=>{e?p({...h,logo:e.url}):p({...h,logo:null})}})]})}}),l.jsx(v(),{style:{float:"right",marginTop:"-20px"},color:"primary",variant:"contained",onClick:G,disabled:a||!b||s,children:s?"Saving...":"Save"})]})};n()}catch(e){n(e)}})},44920:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.r(t),a.d(t,{default:()=>f});var l=a(20997),r=a(16689),s=a(86096),i=a.n(s),o=a(20943),d=a(64515),u=a(62553),c=a(69708),h=e([u]);u=(h.then?(await h)():h)[0];let m=(0,o.loadStripe)("pk_test_6ZAEJTGAGGRruZbIblrsmTMS"),p=({afterFetch:e,onSuccess:t})=>{let[a,n]=(0,r.useState)(!1),[s,o]=(0,r.useState)(!1),[h,m]=(0,r.useState)(null),p=(0,d.useStripe)(),f=(0,d.useElements)(),x=async()=>{o(!0);try{let t=await (0,u.Gy)({path:"/payment-info",method:"GET"});m(t),e&&e(t),o(!1)}catch(e){o(!1),(0,c.Z)(e)}};(0,r.useEffect)(()=>{x()},[]);let j=async e=>{if(e.preventDefault(),!p||!f)return;let{error:a,paymentMethod:l}=await p.createPaymentMethod({type:"card",card:f.getElement(d.CardElement)});if(a)(0,c.Z)(a);else try{n(!0);let e=await (0,u.Gy)({path:"/save-payment-method",method:"POST",data:{paymentMethod:l}});(0,c.Z)("Payment method saved"),m(e),t&&t(e),n(!1)}catch(e){n(!1),(0,c.Z)(e)}};return s||!h?null:(0,l.jsxs)("form",{onSubmit:j,children:[l.jsx(d.CardElement,{className:"StripeElement"}),(0,l.jsxs)(i(),{variant:"contained",color:"primary",type:"submit",disabled:!p||a,children:[h.paymentMethodId?"Update":"Add"," payment method"]})]})},f=function({onSuccess:e,afterFetch:t}){return l.jsx(d.Elements,{stripe:m,children:l.jsx(p,{onSuccess:e,afterFetch:t})})};n()}catch(e){n(e)}})},62724:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.r(t),a.d(t,{default:()=>W});var l=a(20997),r=a(16689),s=a(7988),i=a.n(s),o=a(9285),d=a.n(o),u=a(89580),c=a.n(u),h=a(11256),m=a.n(h),p=a(59127),f=a.n(p),x=a(64745),j=a.n(x),y=a(86096),g=a.n(y),b=a(53456),v=a.n(b),S=a(17155),w=a.n(S),C=a(86024),F=a.n(C),M=a(45845),Z=a.n(M),_=a(4173),P=a.n(_),E=a(69708),O=a(62553),k=a(40063),G=a(2992),T=a(44920),z=e([O,G,T]);[O,G,T]=z.then?(await z)():z;let W=({open:e,onClose:t,onSuccess:a,user:n})=>{let s=n||{_id:null,firstName:"",lastName:"",title:"",email:"",role:"",phone:""},[o,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(null),[x,y]=(0,r.useState)(!1),[b,S]=(0,r.useState)(s.firstName),[C,M]=(0,r.useState)(s.lastName),[_,z]=(0,r.useState)(s.title),[W,A]=(0,r.useState)(s.email),[N,$]=(0,r.useState)(s.phone),[q,D]=(0,r.useState)(s.role),[I,L]=(0,r.useState)(!1),[R,J]=(0,r.useState)(""),[U,B]=(0,r.useState)(""),H=async()=>{y(!0);try{let e=await (0,O.Gy)({path:"/organization",method:"GET"});p(e),y(!1)}catch(e){y(!1)}};(0,r.useEffect)(()=>{H()},[]);let Y=async()=>{if(!W||!R||!U){(0,E.Z)("Please fill in all required fields");return}L(!0);try{await (0,O.Gy)({path:"/users/manage",method:"POST",data:{_id:s._id,firstName:b,lastName:C,title:_,email:W,role:q,phone:N,password:R,passwordConfirm:U}}),a(),L(!1)}catch(e){L(!1),(0,E.Z)(e)}},K=(e,t,a,n,r)=>l.jsx(l.Fragment,{children:(0,k.fM)({label:t,required:r,renderControl:()=>l.jsx(i(),{fullWidth:!0,value:e,onChange:e=>a(e.target.value),type:n})})});if(!h)return null;let Q=I||!o||!o.paymentMethodId;return(0,l.jsxs)(v(),{onClose:t,"aria-labelledby":"modal-title",open:e,fullScreen:!0,style:{width:"40%",left:"inherit"},children:[l.jsx(w(),{id:"modal-title",children:(0,l.jsxs)(d(),{display:"flex",alignItems:"center",children:[l.jsx(d(),{flexGrow:1,children:s._id?"Edit user":"Create a new user"}),(0,l.jsxs)(d(),{children:[l.jsx(F(),{onClick:t,children:l.jsx(P(),{})}),h.subdomain?l.jsx(g(),{variant:"contained",color:"success",onClick:Y,disabled:Q,children:"Save"}):null]})]})}),l.jsx(Z(),{style:{backgroundColor:"#f8f8f8"},children:h.subdomain||s._id?(0,l.jsxs)(l.Fragment,{children:[x||I||!o?l.jsx(m(),{}):null,l.jsx("br",{}),o?o.paymentMethodId?l.jsx(l.Fragment,{children:s._id?null:(0,l.jsxs)(l.Fragment,{children:[l.jsx(c(),{severity:"warning",children:"Adding a user will cost an additional $99 per month"}),l.jsx("br",{})]})}):(0,l.jsxs)(d(),{display:"flex",flexDirection:"column",alignItems:"center",children:[l.jsx(c(),{severity:"warning",children:"Please add your payment method to continue"}),l.jsx("br",{}),l.jsx(T.default,{afterFetch:e=>{u(e)},onSuccess:e=>{u(e)}}),l.jsx("br",{}),l.jsx("br",{})]}):l.jsx(T.default,{afterFetch:e=>{u(e)},onSuccess:e=>{u(e)}}),K(b,"First name",S),K(C,"Last name",M),K(_,"Title",z),K(W,"Email",A,"email",!0),K(N,"Phone",$),(0,k.fM)({label:"Role",renderControl:()=>(0,l.jsxs)(f(),{value:q,onChange:e=>D(e.target.value),fullWidth:!0,children:[l.jsx(j(),{value:"recruiter",children:"Recruiter"}),l.jsx(j(),{value:"admin",children:"Admin (No billing access)"}),l.jsx(j(),{value:"superAdmin",children:"Admin"})]})}),n&&n._id?null:(0,l.jsxs)(l.Fragment,{children:[K(R,"Password",J,"password",!0),K(U,"Password confirm",B,"password",!0)]})]}):(0,l.jsxs)(l.Fragment,{children:[l.jsx(c(),{severity:"warning",children:"Please configure your organization name and subdomain to continue"}),l.jsx("br",{}),l.jsx(G.default,{requireSubdomain:!0})]})})]})};n()}catch(e){n(e)}})}};